<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Island Moments Gallery</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#1A1F2B;
  --secondary:#00A6A6;
  --accent:#F2C94C;
  --matrix-blue:#223C52;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:'Poppins',sans-serif;
  background:#0f1c29;
  color:#fff;
}
/* ================= RESPONSIVE HEADER ================= */

header{
  padding:48px 56px 36px;
  background:linear-gradient(180deg,#0b1622,#0f1c29);
  position:relative;
}

/* Title */
header h1{
  font-size:clamp(26px,4vw,42px);
  margin-bottom:14px;
}

/* Top right controls */
.top-right-controls{
  position:absolute;
  top:24px;
  right:32px;
  display:flex;
  align-items:center;
  gap:14px;
}

/* Countdown */
.countdown{
  font-size:14px;
  font-weight:700;
  padding:8px 16px;
  border-radius:999px;
  display:inline-block;
  margin-bottom:14px;
}

/* Days scroll */
.days-scroll{
  display:flex;
  gap:24px;
  overflow-x:auto;
  padding-bottom:8px;
}

.day{
  font-size:15px;
  opacity:.6;
  cursor:pointer;
  white-space:nowrap;
}

.day.active{
  opacity:1;
}

/* Search */
.search{
  margin-top:22px;
}

.search input{
  width:100%;
  padding:14px 22px;
  border-radius:999px;
  border:none;
  outline:none;
  font-size:15px;
}

/* ================= TABLET ================= */
@media (max-width: 900px){
  header{
    padding:36px 32px;
  }

  .top-right-controls{
    top:18px;
    right:20px;
  }
}

/* ================= MOBILE ================= */
@media (max-width: 600px){
  header{
    padding:26px 18px 30px;
  }

  /* Move controls into flow */
  .top-right-controls{
    position:static;
    justify-content:flex-end;
    margin-bottom:14px;
  }

  header h1{
    text-align:left;
  }

  .countdown{
    font-size:13px;
    padding:6px 12px;
  }

  .days-scroll{
    gap:18px;
  }

  .search input{
    padding:12px 18px;
    font-size:14px;
  }
}


main{padding:40px 48px 80px}

.event-card{
  display:grid;
  grid-template-columns:480px 1fr;
  background:var(--matrix-blue);
  border-radius:18px;
  overflow:hidden;
}

.event-card img{
  width:100%;
  height:100%;
  object-fit:cover;
}

.event-info{
  padding:36px 40px;
  background:linear-gradient(90deg,rgba(34,60,82,.95),rgba(34,60,82,.85));
}

.event-info h2{font-size:28px;margin-bottom:10px}

.actions{
  margin-top:20px;
  display:flex;
  gap:14px;
}

.btn{
  padding:12px 26px;
  border-radius:30px;
  background:#fff;
  color:#0f1c29;
  text-decoration:none;
  font-weight:600;
}

.btn-outline{
  background:transparent;
  border:1px solid #fff;
  color:#fff;
}

/* Gallery */
.gallery-section{
  padding:80px 48px;
  background:#0b1622;
}

.gallery-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:20px;
}

.gallery-grid img{
  width:100%;
  border-radius:14px;
  cursor:pointer;
}

/* Chat */
.support-chat{
  position:fixed;
  bottom:20px;
  right:20px;
  width:280px;
  background:#fff;
  color:#000;
  border-radius:14px;
  overflow:hidden;
}

.chat-header{
  background:var(--accent);
  padding:12px;
  text-align:center;
  font-weight:700;
}

.chat-body{padding:12px}

.chat-input{
  width:100%;
  padding:10px;
  border:none;
  border-top:1px solid #ddd;
}

.top-right-controls{
  position:absolute;
  top:20px;
  right:30px;
  display:flex;
  align-items:center;
  gap:14px;
}

/* ADMIN BUTTON */
#adminBtn{
  background:transparent;
  border:2px solid #fff;
  color:#fff;
  padding:8px 22px;
  border-radius:999px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  line-height:1;
  transition:.25s ease;
}

#adminBtn:hover{
  background:#fff;
  color:#0f1c29;
}

/* LANGUAGE SWITCH */
#langSwitch{
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  line-height:1;
  padding:8px 10px;
  user-select:none;
}.payment-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background: #e11d48;
  color: #fff;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
  z-index: 5;
}
/* ===== MOBILE EVENT CARD FIX ===== */
@media (max-width: 768px) {
  .event-card {
    display: flex;
    flex-direction: column;
  }

  .event-card img {
    width: 100%;
    height: 240px;
    object-fit: cover;
  }

  .event-info {
    padding: 40px;
    background: linear-gradient(
      180deg,
      rgba(34,60,82,0.95),
      rgba(34,60,82,1)
    );
  }
}
/* ===== MOBILE EVENT CARD BUTTON FIX ===== */
@media (max-width: 768px) {

  .event-info .actions {
    flex-direction: column;
    gap: 12px;
    margin-top: 18px;
  }

  .event-info .actions .btn {
    width: 100%;
    text-align: center;
    padding: 14px 0;
    font-size: 16px;
    border-radius: 999px;
  }

}
/* ===== NAVBAR ONE LINE ===== */
.navbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
 min-height:80px;          /* üëà controls height */
  padding:0 56px; 
  background:linear-gradient(180deg,#0b1622,#0f1c29);
}

/* LEFT */
.nav-left{
  display:flex;
  align-items:center;
  gap:14px;
}

.nav-logo{
  height:100px;
  width:auto;
}

/* RIGHT */
.nav-right{
  display:flex;
  align-items:center;
  gap:14px;
}
.navbar h1{
  margin:0;                 /* üëà removes extra height */
  font-size:32px;
}

/* REMOVE OLD ABSOLUTE POSITIONING */
.top-right-controls{
  position:static !important;
}

/* MOBILE */
@media (max-width:600px){
  .navbar{
    padding:20px 18px;
  }

  .nav-logo{
    height:100px;
  }

  .nav-left h1{
    font-size:24px;
  }
}

</style>
</head>

<body>

<header class="navbar">

  <!-- LEFT: LOGO + TITLE -->
  <div class="nav-left">
    <img src="flogo.png" alt="Island Moments Gallery" class="nav-logo">
    <h4>Island Moments Gallery</h4>
  </div>

  <!-- RIGHT: CONTROLS -->
  <div class="nav-right">
    <button id="adminBtn">Admin</button>
    <div id="langSwitch" title="Deutsch">DE</div>
  </div>

</header>

<header>



<div id="countdown" class="countdown"></div>
<div class="days-scroll" id="days"></div>

<div class="search">
  <input id="search" placeholder="Search events..." />
</div>
</header>

<div id="noResults" style="
  display:none;
  padding:40px;
  text-align:center;
  opacity:.7;
  font-size:18px;
">
  No event found
</div>

<main>
  <div id="event"></div>
</main>

<section class="gallery-section">
  <h2>Event Gallery</h2>
  <p class="gallery-sub">All photos free at launch ‚Ä¢ Tap to open ‚Ä¢ Download available</p>
  <div class="gallery-grid" id="galleryGrid"></div>
</section>
<section style="margin:60px auto;max-width:80%">
  <h2>Leave a Review</h2>

  <select id="reviewRating" style="width:100%;padding:12px;margin:10px 0;border-radius:10px">
    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5)</option>
    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê (4)</option>
    <option value="3">‚≠ê‚≠ê‚≠ê (3)</option>
    <option value="2">‚≠ê‚≠ê (2)</option>
    <option value="1">‚≠ê (1)</option>
  </select>

  <textarea
    id="reviewText"
    placeholder="Share your experience‚Ä¶"
    style="width:100%;height:90px;padding:12px;border-radius:10px"
  ></textarea>

  <button
    onclick="submitReview()"
    style="margin-top:12px;background:#00A6A6;color:#fff;border:none;padding:12px 20px;border-radius:30px;cursor:pointer"
  >
    Submit Review
  </button>
</section>

<div class="support-chat">
  <div class="chat-header">Support</div>
  <div class="chat-body" id="chatBody">
    <div class="bot">üëã Hi! What‚Äôs your Instagram handle?</div>
  </div>
  <input class="chat-input" placeholder="@yourhandle" />
</div>

<script>
  
/* ================= DATA ================= */
const today = new Date();

const events = [
  {
    index: 0,
    label: 'Monday',
    weekday: 'Mon',
    date: '',
    title: 'Matrix Monday ‚Äì Hip Hop & RnB',
    music: ['Hip Hop', 'RnB', 'Urban'],
    dj: 'DJ Rasimcan',
    note: 'Free entry before 23:00',
    img: 'https://images.unsplash.com/photo-1514525253161-7a46d19cd819'
  },
  {
    index: 1,
    label: 'Tuesday',
    weekday: 'Tue',
    date: '',
    title: 'Electric Tuesday ‚Äì Techno',
    music: ['Techno', 'Minimal'],
    dj: 'DJ Le Alen',
    note: 'All night techno',
    img: 'https://images.unsplash.com/photo-1507874457470-272b3c8d8ee2'
  },
  {
    index: 2,
    label: 'Wednesday',
    weekday: 'Wed',
    date: '',
    title: 'Island Wednesday ‚Äì Afrobeats',
    music: ['Afrobeats', 'Dancehall'],
    dj: 'DJ Lito Bolton',
    note: 'Island vibes all night',
    img: 'https://images.unsplash.com/photo-1492684223066-81342ee5ff30'
  },
  {
    index: 3,
    label: 'Thursday',
    weekday: 'Thu',
    title: 'Latin Night',
    music: ['Reggaeton', 'Latin'],
    dj: 'DJ Carlos',
    note: 'Hot Latin rhythms',
    img: 'https://images.unsplash.com/photo-1545128485-c400e7702796'
  },
  {
    index: 4,
    label: 'Friday',
    weekday: 'Fri',
    title: 'Island Moments Gallery Friday',
    music: ['House', 'EDM'],
    dj: 'DJ Mike',
    note: 'Biggest party of the week',
    img: 'https://images.unsplash.com/photo-1506157786151-b8491531f063'
  },
  {
    index: 5,
    label: 'Saturday',
    weekday: 'Sat',
    title: 'Main Event Saturday',
    music: ['Mixed', 'Charts'],
    dj: 'Resident DJs',
    note: 'Peak night',
    img: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7'
  },
  {
    index: 6,
    label: 'Sunday',
    weekday: 'Sun',
    title: 'After Hour Sunday',
    music: ['Chill', 'Deep House'],
    dj: 'DJ Relax',
    note: 'Smooth closing vibes',
    img: 'https://images.unsplash.com/photo-1515169067865-5387ec356754'
  }
];


/* ================= ELEMENTS ================= */
const daysEl=document.getElementById('days');
const eventEl=document.getElementById('event');
const searchEl=document.getElementById('search');
const countdownEl=document.getElementById('countdown');
const flag=document.getElementById('langSwitch');
const noResultsEl=document.getElementById('noResults');

/* ================= BUILD DAYS (NEW ‚Äì SAFE ADDITION) ================= */
function buildDays(filterIndex=null){
  daysEl.innerHTML='';
  const used=new Set();

  events.forEach(e=>{
    if(filterIndex!==null && e.index!==filterIndex) return;

    const key=e.label==='Today'?'Today':e.weekday;
    if(used.has(key)) return;
    used.add(key);

    const d=document.createElement('div');
    d.className='day'+((filterIndex===null && e.index===0)||(filterIndex===e.index)?' active':'');
    d.textContent=key;
    d.onclick=()=>selectEvent(e.index);
    daysEl.appendChild(d);
  });
}function getTodayIndex() {
  const today = new Date().toLocaleDateString('en-US', { weekday: 'short' });
  return events.findIndex(e => e.weekday === today);
}


/* ================= RENDER ================= */
function render(e){
  eventEl.innerHTML=`
  <div class="event-card">
    <img src="${e.img}">
    <div class="event-info">
      <div>${e.label} ${e.date} | 22:00</div>
      <h2>${e.title}</h2>
      <ul>
        <li>üéµ ${e.music.join(' ¬∑ ')}</li>
        <li>üéß ${e.dj}</li>
        <li>‚≠ê ${e.note}</li>
      </ul>
      <div class="actions">
        <a class="btn">More information</a>
        <a class="btn btn-outline">Reserve a table</a>
      </div>
    </div>
  </div>`;
}

function selectEvent(i){
  document.querySelectorAll('.day').forEach(d=>d.classList.remove('active'));
  const e=events[i];
  [...daysEl.children].forEach(d=>{
    if(d.textContent===(e.label==='Today'?'Today':e.weekday)) d.classList.add('active');
  });
  render(e);
}

/* ================= COUNTDOWN ================= */
function updateCountdown(){
  const end=events.at(-1).dateObj;
  const days=Math.max(0,Math.ceil((end-new Date())/86400000));
  countdownEl.style.background=days<=5?'#e63946':days<=10?'#f2c94c':'#2ecc71';
  countdownEl.textContent=`${days} ${translations[currentLang].daysLeft}`;
}

/* ================= SEARCH (UPDATED, SAFE) ================= */
searchEl.addEventListener('input',e=>{
  const q=e.target.value.toLowerCase().trim();

  if(!q){
    noResultsEl.style.display='none';
    eventEl.style.display='block';
    buildDays();
    selectEvent(0);
    return;
  }

  const found=events.find(ev=>
    ev.title.toLowerCase().includes(q)||
    ev.music.join(' ').toLowerCase().includes(q)||
    ev.dj.toLowerCase().includes(q)||
    ev.note.toLowerCase().includes(q)
  );

  if(found){
    noResultsEl.style.display='none';
    eventEl.style.display='block';
    buildDays(found.index);
    selectEvent(found.index);
  }else{
    eventEl.style.display='none';
    daysEl.innerHTML='';
    noResultsEl.style.display='block';
    noResultsEl.textContent=translations[currentLang].noResults;
  }
});

/* ================= LANGUAGE ================= */
let currentLang='en';

const translations={
  en:{
    club:'Island Moments Gallerys',
    search:'Search events...',
    gallery:'Event Gallery',
    gallerySub:'All photos free at launch ‚Ä¢ Tap to open ‚Ä¢ Download available',
    more:'More information',
    reserve:'Reserve a table',
    support:'Support',
    chat:'üëã Hi! What‚Äôs your Instagram handle?',
    daysLeft:'DAYS LEFT',
    noResults:'No event found'
  },
  de:{
    club:'Clubn√§chte',
    search:'Events suchen‚Ä¶',
    gallery:'Event Galerie',
    gallerySub:'Alle Fotos gratis ‚Ä¢ Antippen ‚Ä¢ Download verf√ºgbar',
    more:'Mehr Informationen',
    reserve:'Tisch reservieren',
    support:'Support',
    chat:'üëã Wie lautet dein Instagram-Name?',
    daysLeft:'TAGE √úBRIG',
    noResults:'Kein Event gefunden'
  }
};

flag.onclick=()=>{
  currentLang=currentLang==='en'?'de':'en';
  applyLang();
};

function applyLang(){
  const t=translations[currentLang];
  document.querySelector('h1').textContent=t.club;
  searchEl.placeholder=t.search;
  document.querySelector('.gallery-section h2').textContent=t.gallery;
  document.querySelector('.gallery-sub').textContent=t.gallerySub;
  document.querySelector('.chat-header').textContent=t.support;
  document.getElementById('chatBody').innerHTML=`<div class="bot">${t.chat}</div>`;
  document.querySelector('.btn').textContent=t.more;
  document.querySelector('.btn-outline').textContent=t.reserve;
  flag.textContent=currentLang==='en'?'DE':'EN';
  updateCountdown();
  if(noResultsEl.style.display==='block') noResultsEl.textContent=t.noResults;
}

/* ================= INIT ================= */
const todayIndex = getTodayIndex();

buildDays();
selectEvent(todayIndex !== -1 ? todayIndex : 0);
updateCountdown();
setInterval(updateCountdown,3600000);

document.getElementById('adminBtn').onclick=()=>{
window.location.href='admin-login.html';
};// ===== SIMPLE ANALYTICS =====
const analytics = JSON.parse(localStorage.getItem('analytics') || '{}');

analytics.visits = (analytics.visits || 0) + 1;

// unique user (per browser)
if (!localStorage.getItem('uniqueUser')) {
  localStorage.setItem('uniqueUser', '1');
  analytics.uniqueUsers = (analytics.uniqueUsers || 0) + 1;
}

localStorage.setItem('analytics', JSON.stringify(analytics));
const galleryGrid = document.getElementById('galleryGrid');

function renderEventGallery() {
  const now = Date.now();

  const items = JSON.parse(localStorage.getItem('eventGallery') || '[]')
    .filter(i => i.expiresAt > now);

  const covers = JSON.parse(localStorage.getItem('albumCovers') || '{}');

  galleryGrid.innerHTML = '';
  if (!items.length) return;

  // group by date
  const grouped = {};
  items.forEach(i => {
    if (!grouped[i.date]) grouped[i.date] = [];
    grouped[i.date].push(i);
  });

  Object.keys(grouped).forEach(date => {
    const coverUrl = covers[date] || grouped[date][0].url;

    const wrap = document.createElement('div');
    wrap.style.position = 'relative';
    wrap.style.cursor = 'pointer';

    const img = document.createElement('img');
    img.src = coverUrl;

    const label = document.createElement('div');
    label.textContent = new Date(date).toDateString();
    label.style.position = 'absolute';
    label.style.bottom = '12px';
    label.style.left = '12px';
    label.style.background = 'rgba(0,0,0,.7)';
    label.style.padding = '6px 12px';
    label.style.borderRadius = '999px';
    label.style.fontSize = '13px';
    label.style.fontWeight = '600';

    wrap.appendChild(img);
    wrap.appendChild(label);

    wrap.onclick = () => openAlbum(date, grouped[date]);

    galleryGrid.appendChild(wrap);
  });
}
function openAlbum(date, photos) {
  galleryGrid.innerHTML = '';

  const h = document.createElement('h2');
  h.textContent = new Date(date).toDateString();
  h.style.gridColumn = '1 / -1';
  h.style.margin = '10px 0 20px';

  galleryGrid.appendChild(h);

  photos.forEach(item => {
    const wrap = document.createElement('div');
    wrap.style.position = 'relative';

    // IMAGE
    const img = document.createElement('img');
    img.src = item.url;
    img.style.width = '100%';
    img.style.borderRadius = '14px';

    // DOWNLOAD BUTTON
    const btn = document.createElement('button');
    btn.textContent = 'Download';
    btn.className = 'btn';
    btn.style.position = 'absolute';
    btn.style.bottom = '12px';
    btn.style.left = '50%';
    btn.style.transform = 'translateX(-50%)';

    btn.onclick = () => handleDownload(item.url);

    // PAYMENT BADGE
    const paymentsEnabled = localStorage.getItem('paymentsEnabled') === 'true';
  if (paymentsEnabled) {
  const badge = document.createElement('div');
  badge.className = 'payment-badge';
  badge.textContent = 'Paid';
  wrap.appendChild(badge);
}


    wrap.appendChild(img);
    wrap.appendChild(btn);
    galleryGrid.appendChild(wrap);
  });
}

function isPaid(url){
  const paid = JSON.parse(localStorage.getItem('paid') || '[]');
  return paid.includes(url);
}

function markPaid(url){
  const paid = JSON.parse(localStorage.getItem('paid') || '[]');
  paid.push(url);
  localStorage.setItem('paid', JSON.stringify(paid));
}
function submitReview(){
  const rating = document.getElementById('reviewRating').value;
  const text = document.getElementById('reviewText').value.trim();

  if (!text) {
    alert('Please write a review');
    return;
  }

  const reviews = JSON.parse(localStorage.getItem('reviews') || '[]');

  reviews.unshift({
    rating,
    text,
    date: Date.now()
  });

  localStorage.setItem('reviews', JSON.stringify(reviews));

  document.getElementById('reviewText').value = '';
  alert('Thank you for your review!');
}
function handleDownload(imageUrl) {
  // Store image temporarily
  localStorage.setItem("pendingDownload", imageUrl);

  // üîó YOUR STRIPE PAYMENT LINK
  window.location.href =
    "https://checkout.stripe.com/c/pay/cs_test_a17f79NoCoRCD5SoGTgNW0O8IfR0bWLn6vvjd5lbdoIGqMmwTMhVK3WQK8#fidnandhYHdWcXxpYCc%2FJ2FgY2RwaXEnKSdkdWxOYHwnPyd1blpxYHZxWjA0V1xDQUlCYm1fSFBOU2BEdT1DNkRiVHwyN2NyVlxOUHNTSWZnbGFIUn1MT3MwSDM0YUhPdVVhNFVDMWNzQTEzNWExczxcb0p8QzBIcFRSM09vMDNhcmYxNTUwVWoyMDxNSicpJ2N3amhWYHdzYHcnP3F3cGApJ2dkZm5id2pwa2FGamlqdyc%2FJyY3YTAxZzwnKSdpZHxqcHFRfHVgJz8ndmxrYmlgWmxxYGgnKSdga2RnaWBVaWRmYG1qaWFgd3YnP3F3cGB4JSUl";
}


function loadImage(src) {
  return new Promise((resolve, reject) => {
    const img = new Image();
    img.crossOrigin = 'anonymous';
    img.onload = () => resolve(img);
    img.onerror = reject;
    img.src = src;
  });
}


function cleanupExpiredPhotos() {
  const now = Date.now();

  ['images', 'eventGallery'].forEach(key => {
    const data = JSON.parse(localStorage.getItem(key) || '[]')
      .filter(i => i.expiresAt > now);
    localStorage.setItem(key, JSON.stringify(data));
  });
}

cleanupExpiredPhotos();

renderEventGallery();
const params = new URLSearchParams(window.location.search);

if (params.get("paid") === "true") {
  const imageUrl = localStorage.getItem("pendingDownload");

  if (imageUrl) {
    const a = document.createElement("a");
    a.href = imageUrl;
    a.download = "island-moments.jpg";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);

    localStorage.removeItem("pendingDownload");
  }
}


</script>
<script src="https://js.stripe.com/v3/"></script>
<script>
  const stripe = Stripe(
    "pk_test_51RExonP3IGBtyE3AuXHnPvTSXV0qkkXZpZcjOAVIBIRR6g3jX0lIgENADoEzwlZJWrCqvaV3oHZQtmhjqNivshFE00sWlLvzel"
  );
</script>

<script src="firebase.js" type="module"></script>
<script type="module" src="./auth.js"></script></body>
</html>
